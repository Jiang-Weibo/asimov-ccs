\documentclass[11pt]{article}

\usepackage{epcc}
\usepackage{color}
\usepackage[pdftex]{graphicx}
\usepackage{subcaption}
\usepackage{newfloat}
\usepackage{bm}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage[svgnames]{xcolor}
  \definecolor{diffstart}{named}{Grey}
  \definecolor{diffincl}{named}{Green}
  \definecolor{diffrem}{named}{Red}
\usepackage{listings}
  \lstdefinelanguage{diff}{
    basicstyle=\ttfamily\small,
    morecomment=[f][\color{diffstart}]{@@},
    morecomment=[f][\color{diffincl}]{+\ },
    morecomment=[f][\color{diffrem}]{-\ },
  }

\hypersetup{colorlinks}
\usepackage{float}

\hyphenpenalty=500

% This is for ``figures'' which are to have a caption
% labelled ``Benchmark''.
\DeclareFloatingEnvironment[
  name=Benchmark,
  placement=tbhp,
  within=section,
]{benchmark}


\definecolor{terminalcolour}{gray}{0.96}

% Code fragments are gray...
\lstdefinestyle{codefragment}{
  basicstyle=\small\ttfamily,
  backgroundcolor=\color{terminalcolour},
  xleftmargin=0pt
}

% Benchmark tables
\lstdefinestyle{terminalverbatim}{
  basicstyle=\small\ttfamily,
  xleftmargin=0pt
}

\lstset{showstringspaces=false}

\renewcommand{\refname}{Notes and References}


\begin{document}
\lstset{style=codefragment}


\title{ASiMoV CCS}

\date{July 2021}
\author{EPCC}

\makeEPCCtitle

\centerline{\sc Programming style guide}

\tableofcontents
\pagebreak

\bigskip

%\hrule

\bigskip

% CONTENT HERE

\section{Introduction}
TODO - what is this document

\section{Fortran standard}
TODO - code must follow Fortran 2018 standard

\section{Naming conventions and capitalisation}
All Fortran keywords must be written in lower case.

\section{Layout and formatting}
The following is a list of recommended practices for layout and formatting for ASiMoV CCS.

\begin{itemize}
\item Templates are provided for modules, submodules, functions, subroutines, and programs. The templates should always be as a starting point for new code.
\item Indent blocks by 2 spaces. Where possible, comments should be indented with the code within a block.
\item Use space and blank lines where appropriate to format your code to improve readability.
\item Where possible, avoid using continuation lines in a statement.
\item Avoid putting multiple statements on the same line.
\item Each program unit should follow a defined structure. The intended behaviour of the unit should be clearly described in the header.
\item Comments should start with a single ! at beginning of the line. A blank line should be left before (but not after) the comment line. The exception is for one line comments which can be indented within the code or placed after the statement.
\item Each module should be in a separate file.
\end{itemize}


\section{Style}

\subsection{Array notation}
In order to make it clear that variables used in an assignment are arrays, always use array notation.

Common practice, bad for readability:
\begin{lstlisting}[
	language=fortran,
    basicstyle=\fontsize{7}{10}\ttfamily
    \label{lst:array_bad}
]
integer :: a(10, 20), b(10, 20)
a = b ! Bad
\end{lstlisting}

Better practice, improved readability:
\begin{lstlisting}[
	language=fortran,
    basicstyle=\fontsize{7}{10}\ttfamily
    \label{lst:array_good}
]
integer :: a(10, 20), b(10, 20)
a(:) = b(:) ! Good
\end{lstlisting}

\subsection{Parentheses}
Improve readability of mathematical formulas by explicity using parentheses.

Common practice, bad for readability:
\begin{lstlisting}[
	language=fortran,
    basicstyle=\fontsize{7}{10}\ttfamily
    \label{lst:parens_bad}
]
integer :: a, b, c, d
a = b * c + d ! Bad
\end{lstlisting}

Better practice, improved readability:
\begin{lstlisting}[
	language=fortran,
    basicstyle=\fontsize{7}{10}\ttfamily
    \label{lst:parens_good}
]
integer :: a, b, c, d
a = (b * c) + d ! Good
\end{lstlisting}

\subsection{Spaces between keywords}
The following keywords should be written with spaces, rather than as a single word:
\begin{lstlisting}[
	language=fortran,
    basicstyle=\fontsize{7}{10}\ttfamily
    \label{lst:parens_good}
]
else if
end if
end do
end forall
end function
end subroutine
end interface
end select
end type
end where
end module
end program
select case
\end{lstlisting}

%\bibliographystyle{plain}
%\begin{thebibliography}{10}

% \bibitem{press} See, e.g., \textit{Numerical Recipes in Fortran}, W.H. Press, S.A. Teukolsky, W.T. Vettering, and B.R. Flannery (Cambridge University Press).

%\end{thebibliography}

\end{document}

